اگر توکن (مثلاً JWT) را در LocalStorage یا SessionStorage نگه دارید و از طریق هدر Authorization ارسال کنید:

هر اسکریپت مخرب (XSS) که در صفحه اجرا شود می‌تواند به آن دسترسی داشته باشد.

مهاجم می‌تواند توکن را بخواند و برای جعل هویت استفاده کند.

اما اگر توکن داخل Cookie با ویژگی HttpOnly ذخیره شود:

JavaScript سمت کلاینت به آن دسترسی ندارد.

در نتیجه، حتی اگر XSS رخ دهد، مهاجم نمی‌تواند توکن را مستقیماً سرقت کند.

نتیجه:
کوکی HttpOnly سطح محافظت در برابر سرقت توکن از طریق XSS را افزایش می‌دهد.


کوکی‌ها چند فلگ مهم دارند:

Secure → فقط از طریق HTTPS ارسال می‌شود.

HttpOnly → قابل دسترسی توسط JavaScript نیست.

SameSite (Strict/Lax) → از ارسال کوکی در درخواست‌های Cross-Site جلوگیری یا محدود می‌کند.

محافظت در برابر CSRF

اگر SameSite=Lax یا Strict تنظیم شود، مرورگر در بسیاری از درخواست‌های Cross-Site کوکی را ارسال نمی‌کند.

در نتیجه، حملات CSRF تا حد زیادی کاهش می‌یابد.

همچنین می‌توان CSRF Token Pattern را کنار کوکی استفاده کرد (Double Submit Cookie).



